import numpy as np
from scipy import interpolate

"""
Helper to define age depent tabular values for root conductivities for XylemFluxPython (values are hard coded)

TODO this should be improved !

usage:  after calling:
init_conductivities(r :XylemFluxPython, age_dependent :bool)

use:
r.kr_f(age, type)
r.kx_f(age, type) 

"""

def init_conductivities(r, age_dependent:bool = False):
    """ call to initialize age dependent or independent conductivities, 
    initializes functions kr(age, type) and kx(age, type) """

    # tabular values for age and type depenent case [age, value] for type 0 (kr0), and type 1 (kr1)
    '''Root conductivities with exponential growth'''
    kr1 = np.array([
        [0.10748958, 0.000106343],
        [0.161379976, 0.000106008],
        [0.215367912, 0.000106236],
        [0.26945374, 0.000106033],
        [0.323637817, 0.000106347],
        [0.3779205, 0.00010643],
        [0.432302149, 0.000106263],
        [0.650825663, 0.000106385],
        [0.87096191, 0.000106457],
        [1.092734874, 0.000105761],
        [1.541289585, 0.000113566],
        [1.768122056, 0.00011429],
        [1.996692724, 4.00E-05],
        [2.227028433, 3.99E-05],
        [2.459156657, 4.00E-05],
        [2.693105512, 3.99E-05],
        [2.928903785, 4.00E-05],
        [3.166580949, 3.68E-05],
        [3.406167186, 3.68E-05],
        [4.633843597, 3.89E-05],
        [7.252043149, 4.10E-05],
        [10.12236428, 4.29E-05]
    ])

    kz1 = np.array([
        [0.10748958, 0.001428701],
        [0.161379976, 0.001411575],
        [0.215367912, 0.001503535],
        [0.26945374, 0.001474202],
        [0.323637817, 0.001372298],
        [0.3779205, 0.001462689],
        [0.432302149, 0.001406009],
        [0.650825663, 0.001467545],
        [0.87096191, 0.001407742],
        [1.092734874, 0.00151302],
        [1.541289585, 0.001336126],
        [1.768122056, 0.001350818],
        [1.996692724, 0.001348176],
        [2.227028433, 0.00195872],
        [2.693105512, 0.161388966],
        [2.928903785, 0.163310872],
        [3.166580949, 0.171753617],
        [3.406167186, 0.173627719],
        [4.633843597, 0.161798441],
        [7.252043149, 0.243831044],
        [10.12236428, 0.333556853]
    ])

    #seminal
    kr4 = np.array([
        [0.12909831, 0.000112594],
        [0.193822343, 0.000112978],
        [0.258663523, 0.000113248],
        [0.323622275, 0.000112912],
        [0.388699028, 0.000113171],
        [0.453894209, 0.000113439],
        [0.519208251, 0.000113637],
        [0.781661749, 0.000121677],
        [1.046052191, 0.00012169],
        [1.312408379, 0.000122518],
        [1.580759763, 0.00012298],
        [1.85113646, 0.000122788],
        [2.123569273, 0.000123039],
        [2.398089714, 0.000123636],
        [2.674730025, 0.0001233],
        [2.953523201, 4.22E-05],
        [3.234503012, 4.23E-05],
        [3.517704031, 4.24E-05],
        [3.803161655, 4.25E-05],
        [4.090912136, 4.26E-05],
        [5.565389475, 3.93E-05],
        [8.709928112, 4.16E-05],
        [12.15727256, 4.31E-05]
    ])

    kz4 = np.array([
        [0.12909831, 0.001043448],
        [0.193822343, 0.001084252],
        [0.258663523, 0.001052552],
        [0.323622275, 0.001103842],
        [0.388699028, 0.00108313],
        [0.453894209, 0.001067554],
        [0.519208251, 0.001006955],
        [0.781661749, 0.000973576],
        [1.046052191, 0.000976876],
        [1.312408379, 0.000985499],
        [1.580759763, 0.000907123],
        [1.85113646, 0.000865667],
        [2.123569273, 0.000801025],
        [2.398089714, 0.000818666],
        [2.674730025, 0.000870364],
        [2.953523201, 0.000843755],
        [3.234503012, 0.000833276],
        [3.517704031, 0.000911009],
        [3.803161655, 0.000875389],
        [4.090912136, 0.000898246],
        [5.565389475, 0.112154361],
        [8.709928112, 0.101482174],
        [12.15727256, 0.150518048]
    ])

    kr2 = np.array([
        [0.243904673, 0.000118148],
        [0.375243914, 0.000117727],
        [0.513747967, 0.000117599],
        [0.660243877, 0.000118013],
        [0.815710704, 0.000117724],
        [0.981319231, 0.000117804],
        [1.158485533, 0.000117637],
        [2.024739266, 0.000117638],
        [3.349677885, 0.000117924],
        [6.282752364, 3.75E-05]
    ])

    kz2 = np.array([
        [0.243904673, 4.48E-05],
        [0.375243914, 4.63E-05],
        [0.513747967, 3.62E-05],
        [0.660243877, 4.87E-05],
        [0.815710704, 3.97E-05],
        [0.981319231, 4.29E-05],
        [1.158485533, 4.66E-05],
        [2.024739266, 4.22E-05],
        [3.349677885, 3.86E-05],
        [6.282752364, 4.21E-05]
    ])

    kr3 = np.array([
        [0.296274974, 0.000129391],
        [0.530053444, 0.000129699],
        [0.92489003, 0.000129233],
        [2.834286141, 0.000129567]
    ])

    kz3 = np.array([
        [0.296274974, 1.49E-05],
        [0.530053444,1.60E-05],
        [0.92489003, 1.58E-05]])

    # shoot-born
    kr5 = np.array([
        [0.107343906, 0.000133676],
        [0.161161267, 0.000133827],
        [0.215076036, 0.000133532],
        [0.269088565, 0.000133534],
        [0.323199209, 0.000134758],
        [0.377408326, 0.000134415],
        [0.431716275, 0.000135286],
        [0.649943636, 0.000135067],
        [0.869781546, 0.000140551],
        [1.091253953, 0.000141006],
        [1.314385345, 0.00014217],
        [1.539200764, 0.000142592],
        [1.765725822, 0.000147261],
        [1.993986721, 0.000148067],
        [2.22401027, 0.000148443],
        [2.455823903, 0.00013956],
        [2.689455702, 0.000144219],
        [2.924934411, 5.28E-05],
        [3.162289464, 5.28E-05],
        [3.401551004, 5.31E-05],
        [4.627563616, 5.08E-05],
        [7.242214873, 5.24E-05],
        [10.10864602, 5.67E-05]
    ])

    kz5 = np.array([
        [0.107343906, 0.006101211],
        [0.161161267, 0.006128716],
        [0.215076036, 0.006138274],
        [0.269088565, 0.006037813],
        [0.323199209, 0.006311727],
        [0.377408326, 0.005902104],
        [0.431716275, 0.005960428],
        [0.649943636, 0.005785935],
        [0.869781546, 0.005770295],
        [1.091253953, 0.006697144],
        [1.314385345, 0.007411226],
        [1.539200764, 0.006981372],
        [1.765725822, 0.006388351],
        [1.993986721, 0.00680202],
        [2.22401027, 0.006945852],
        [2.689455702, 1.427732171],
        [2.924934411, 1.516871436],
        [3.162289464, 1.607222779],
        [3.401551004, 1.691691634],
        [4.627563616, 2.344891587],
        [7.242214873, 4.094611567],
        [10.10864602, 6.608610426]
    ])


    r.setKrTables([[ kr1[:, 1], kr2[:, 1], kr3[:, 1], kr4[:, 1], kr5[:, 1]]],
            [[kr1[:, 0], kr2[:, 0], kr3[:, 0], kr4[:, 0], kr5[:, 0]]])
    r.setKxTables([[kz1[:, 1], kz2[:, 1], kz3[:, 1], kz4[:, 1], kz5[:, 1]]],
            [[kz1[:, 0], kz2[:, 0], kz3[:, 0], kz4[:, 0], kz5[:, 0]]])
